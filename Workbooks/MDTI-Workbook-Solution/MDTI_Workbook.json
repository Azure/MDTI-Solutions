{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "MDTI WORKBOOK",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "azure monitor",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2022-04-01",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# [Microsoft Defender Threat Intelligence Workbook](https://learn.microsoft.com/en-us/defender/threat-intelligence/what-is-microsoft-defender-threat-intelligence-defender-ti) \\r\\n---\\r\\nThe Microsoft’s Defender Threat Intelligence Workbook provides different data feeds to enable network protection and disruption scenarios for MDTI Premium subscribers, and to facilitate remediation of the compromised systems.Within a Security Information and Event Management (SIEM) solution like Microsoft Sentinel, the most commonly used form of CTI is threat indicators, also known as Indicators of Compromise or IoCs. Threat indicators are data that associate observed artifacts such as URLs, file hashes, or IP addresses with known threat activity such as phishing, botnets, or malware. This form of threat intelligence is often called tactical threat intelligence because it can be applied to security products and automation in large scale to detect potential threats to an organization and protect against them. In Microsoft Sentinel, you can use threat indicators to help detect malicious activity observed in your environment and provide context to security investigators to help inform response decisions.\\r\\n\\r\\n**Note** \\r\\n- The workbook visualizes incidents triggered by MDTI within Microsoft Sentinel as well gives the user the opportunity to search IOC information specifically to Hosts and IPs .it will provide crucial information such as **reputation scoring , components , cookies , Trackers and Threat Intelligence details ** that a SOC analyst/ Operator can use to enrich their investigation and Threat hunting scenarios\\r\\n- To leverage the workbook you will require access to an **MDTI Premium license** and the **API license **\\r\\n\\r\\n\\r\\n\"},\"name\":\"text - 11\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"value::all\"],\"parameters\":[{\"id\":\"738d94b8-3f93-4379-b098-963e523aa839\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"AzureFunction\",\"label\":\"Deployed-AzureFunction\",\"type\":2,\"isRequired\":true,\"query\":\"resources\\r\\n| where type == \\\"microsoft.web/sites\\\"\\r\\n| where kind contains \\\"functionapp\\\"\\r\\n| project name \",\"crossComponentResources\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"value\":\"mdtiworkbookwqhoziw22vyeg\"}],\"style\":\"pills\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"name\":\"parameters - 20\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"156016fd-8949-4999-839f-2f65066cba1f\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"MDTI Sentinel Incident view\",\"subTarget\":\"MdtiSentinel\",\"style\":\"link\"},{\"id\":\"82d66787-1fee-425e-9131-a6c82e9d286b\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Hostname Information\",\"subTarget\":\"HostName\",\"preText\":\"host\",\"style\":\"link\"},{\"id\":\"02c493d9-af05-4931-a2fc-aacf100bfe29\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"IP Address Information\",\"subTarget\":\"IpAddress\",\"style\":\"link\"},{\"id\":\"16ea4775-91fd-438c-a876-178c7c76fee8\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"MDTI Articles\",\"subTarget\":\"ArticlesList\",\"style\":\"link\"},{\"id\":\"34edbc87-b524-408e-a3d1-4018b8cd6233\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Vulnerabilities Information\",\"subTarget\":\"Vulnerabilities\",\"style\":\"link\"},{\"id\":\"2140b871-897f-4d49-b12e-e102ad41472e\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Intel Profiles\",\"subTarget\":\"Intels\",\"style\":\"link\"},{\"id\":\"76cc747d-66f0-43bd-898e-69249fe3b754\",\"cellValue\":\"Nav\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Threat Intelligence Guide\",\"subTarget\":\"guide\",\"style\":\"link\"}]},\"name\":\"links - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"crossComponentResources\":[\"{Subscription}\"],\"parameters\":[{\"id\":\"da0f1ab5-c8c6-4185-95e7-668d39e415e6\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Subscription\",\"type\":6,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"includeAll\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":\"/subscriptions/1c61ccbf-70b3-45a3-a1fb-848ce46d70a6\"},{\"id\":\"8fa8888b-c5ec-4618-8275-eb8d989f5ae6\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Workspace\",\"type\":5,\"isGlobal\":true,\"query\":\"resources\\r\\n| where type == 'microsoft.operationalinsights/workspaces'\\r\\n| project id, name\\r\\n| order by tolower(name) asc\",\"crossComponentResources\":[\"{Subscription}\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"value\":\"/subscriptions/1c61ccbf-70b3-45a3-a1fb-848ce46d70a6/resourceGroups/Admin/providers/Microsoft.OperationalInsights/workspaces/AdminSOC\"},{\"id\":\"eb4bb4da-ebbe-4106-8360-2677f98a3a46\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}}],\"style\":\"pills\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"name\":\"parameters - 7\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let IP_Data = \\r\\n    external_data(network:string,geoname_id:long,continent_code:string,continent_name:string ,country_iso_code:string,    country_name:string,is_anonymous_proxy:bool,is_satellite_provider:bool)\\r\\n    [@\\\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\\\"]\\r\\n    with (ignoreFirstRecord=true, format=\\\"csv\\\");\\r\\nThreatIntelligenceIndicator\\r\\n| extend IPaddress=tostring(NetworkIP)\\r\\n| where isnotempty(IPaddress) \\r\\n| evaluate ipv4_lookup(IP_Data, IPaddress,network)\\r\\n\\r\\n\\r\\n\",\"size\":0,\"title\":\"Threat intelligence IPs pulled by TI\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"NetworkIP\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"ConfidenceScore\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"74\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"customWidth\":\"22\",\"name\":\"query - 0\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let IP_Data = \\r\\n    external_data(network:string,geoname_id:long,continent_code:string,continent_name:string ,country_iso_code:string,    country_name:string,is_anonymous_proxy:bool,is_satellite_provider:bool)\\r\\n    [@\\\"https://raw.githubusercontent.com/datasets/geoip2-ipv4/master/data/geoip2-ipv4.csv\\\"]\\r\\n    with (ignoreFirstRecord=true, format=\\\"csv\\\");\\r\\nThreatIntelligenceIndicator\\r\\n| extend IPaddress=tostring(NetworkIP)\\r\\n| where isnotempty(IPaddress) \\r\\n| evaluate ipv4_lookup(IP_Data, IPaddress,network)\",\"size\":0,\"title\":\"Threat indicators Network IPs pulled from MDTI into Sentinel\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"map\",\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"country_name\",\"sizeSettings\":\"ConfidenceScore\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"ConfidenceScore\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ConfidenceScore\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"40\",\"name\":\"query - 1\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let tiObservables = ThreatIntelligenceIndicator\\r\\n    | where TimeGenerated < now()\\r\\n    | project IndicatorId, ThreatType, Description, Active, IndicatorTime = TimeGenerated, Indicator = strcat(NetworkSourceIP, NetworkIP, NetworkDestinationIP, Url, FileHashValue, EmailSourceIpAddress, EmailSenderAddress, DomainName), SourceSystem;\\r\\nlet alertEntity = SecurityAlert \\r\\n    | project parse_json(Entities), SystemAlertId , AlertTime = TimeGenerated\\r\\n    | mvexpand(Entities)\\r\\n    | extend entity = iif(isnotempty(Entities.Address), Entities.Address,\\r\\n                      iif(isnotempty(Entities.HostName),strcat(Entities.HostName, \\\".\\\", Entities.DnsDomain),\\r\\n                      iif(isnotempty(Entities.Url), Entities.Url,\\r\\n                      iif(isnotempty(Entities.Value), Entities.Value,\\r\\n                      iif(Entities.Type == \\\"account\\\", strcat(Entities.Name,\\\"@\\\",Entities.UPNSuffix),\\\"\\\")))))\\r\\n    | where isnotempty(entity) \\r\\n    | project entity, SystemAlertId, AlertTime;\\r\\nlet IncidentAlerts = SecurityIncident\\r\\n    | project IncidentTime = TimeGenerated, IncidentNumber, Title, parse_json(AlertIds)\\r\\n    | mv-expand AlertIds\\r\\n    | project IncidentTime, IncidentNumber, Title, tostring(AlertIds);\\r\\nlet AlertsWithTiObservables = alertEntity\\r\\n    | join kind=inner tiObservables on $left.entity == $right.Indicator;\\r\\nlet IncidentsWithAlertsWithTiObservables = AlertsWithTiObservables\\r\\n    | join kind=inner IncidentAlerts on $left.SystemAlertId == $right.AlertIds;\\r\\nIncidentsWithAlertsWithTiObservables\\r\\n| summarize Incidents=dcount(IncidentNumber), Alerts=dcount(SystemAlertId) by Indicator, ThreatType, Source = SourceSystem, Description\\r\\n| where Source contains \\\"Threat Intelligence\\\" \\r\\n| sort by Incidents, Alerts desc\",\"size\":0,\"title\":\"Threat Intelligence Alerts\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Source\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Threat Intelligence Analytics\",\"representation\":\"Noisy\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Emerging Threat Feed\",\"representation\":\"Important\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Microsoft Defender Threat Intelligence\",\"representation\":\"Noisy\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"38\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\r\\n| extend SystemAlertId = tostring(AlertIds[0])\\r\\n| join (SecurityAlert \\r\\n| where Entities <> \\\"\\\"\\r\\n| mv-expand parse_json(Entities)\\r\\n| where Entities != \\\"\\\"\\r\\n| project SystemAlertId, Entities\\r\\n) on SystemAlertId\\r\\n| where Title == \\\"Microsoft Threat Intelligence Analytics\\\"\\r\\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\\r\\n| parse IncidentUrl with * '/#asset/Microsoft_Azure_Security_Insights/Incident' IncidentBlade\\r\\n| extend SeverityRank=iff(Severity == \\\"High\\\", 3, iff(Severity == \\\"Medium\\\", 2, iff(Severity == \\\"Low\\\", 1, iff(Severity == \\\"Informational\\\", 0, 0))))\\r\\n| sort by SeverityRank, IncidentNumber desc\\r\\n| project Title, IncidentNumber, Severity, IncidentUrl, FirstActivityTime, IncidentBlade, Entities\\r\\n| limit 2500\",\"size\":0,\"title\":\"Incident Trigger with MDTI Analytic Rule\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"High\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"IncidentUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let DomainQuery=view() { \\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(DomainName)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by DomainName\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"DomainEntry\\\"\\r\\n};\\r\\nlet UrlQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(Url)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by Url\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"UrlEntry\\\"\\r\\n};\\r\\nlet FileHashQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(FileHashValue)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by FileHashValue\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"FileHashEntry\\\"\\r\\n};\\r\\nlet IPQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(NetworkIP) or isnotempty(NetworkSourceIP)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by NetworkIP, NetworkSourceIP\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"IPEntry\\\"\\r\\n};\\r\\nlet EmailAddressQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(EmailSenderAddress)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSenderAddress\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"EmailAddressEntry\\\"\\r\\n};\\r\\nlet EmailMessageQuery=view(){\\r\\nThreatIntelligenceIndicator\\r\\n| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n| where isnotempty(EmailSubject)\\r\\n| summarize SourceSystemArray=make_set(SourceSystem) by EmailSubject\\r\\n| summarize count() by tostring(SourceSystemArray)\\r\\n| project SourceSystemArray, count_, EntryType=\\\"EmailMessageEntry\\\"\\r\\n};\\r\\nlet SingleSourceIndicators=view(){\\r\\n    DomainQuery\\r\\n    | union UrlQuery\\r\\n    | union FileHashQuery\\r\\n    | union IPQuery\\r\\n    | union EmailAddressQuery\\r\\n    | union EmailMessageQuery\\r\\n    | where array_length(todynamic(SourceSystemArray))==1\\r\\n    | summarize sum(count_) by SourceSystemArray\\r\\n    | extend counter=1 \\r\\n};\\r\\nlet MultipleSourceIndicators=view(){\\r\\n    DomainQuery\\r\\n    | union UrlQuery\\r\\n    | union FileHashQuery\\r\\n    | union IPQuery\\r\\n    | union EmailAddressQuery\\r\\n    | union EmailMessageQuery\\r\\n    | where array_length(todynamic(SourceSystemArray))!=1\\r\\n    | summarize sum(count_) by SourceSystemArray\\r\\n    | extend counter=1\\r\\n};\\r\\nlet CountOfActiveIndicatorsBySource=view(){\\r\\n    ThreatIntelligenceIndicator\\r\\n\\t| summarize arg_max(TimeGenerated, *) by IndicatorId\\r\\n    | where ExpirationDateTime > now() and Active == true\\r\\n    | summarize count() by SourceSystem\\r\\n    | project SourceSystem, count_\\r\\n};\\r\\nSingleSourceIndicators\\r\\n| join kind=fullouter MultipleSourceIndicators on counter \\r\\n| where SourceSystemArray contains todynamic(SourceSystemArray)[0] \\r\\n| order by SourceSystemArray\\r\\n| extend solitary_count=sum_count_\\r\\n| summarize shared_count = sum(sum_count_1) by SourceSystemArray, solitary_count\\r\\n| extend total_count = shared_count + solitary_count\\r\\n| extend unique_percentage = round(toreal(solitary_count)/toreal(total_count)*100, 1)\\r\\n| extend IndicatorSource = tostring(todynamic(SourceSystemArray)[0])\\r\\n| join kind=inner CountOfActiveIndicatorsBySource on $left.IndicatorSource == $right.SourceSystem\\r\\n| order by unique_percentage desc\\r\\n| project Source=IndicatorSource, UniquenessPercentage=unique_percentage, ActiveIndicators = count_\",\"size\":0,\"title\":\"Uniqueness of Threat Intelligence Sources\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Source\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"View\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"ActiveIndicators\",\"formatter\":4,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"customWidth\":\"50\",\"name\":\"query - 5\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"ThreatIntelligenceIndicator\\r\\n| where SourceSystem contains \\\"Microsoft Threat Intelligence Analytics\\\"\\r\\n|project ConfidenceScore, Description, DomainName, NetworkIP\",\"size\":0,\"title\":\"Threat indicators pulled from MDTI\",\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"sortBy\":[{\"itemKey\":\"Description\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"Description\",\"sortOrder\":1}]},\"customWidth\":\"50\",\"name\":\"query - 3\",\"styleSettings\":{\"showBorder\":true}}],\"exportParameters\":true},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"MdtiSentinel\"},\"name\":\"group - 15\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"Web components are details describing a web page or a server infrastructure. This data is generated by performing web crawling and port scanning. These components allow a user to understand the makeup of a webpage or the technology and services driving a specific piece of infrastructure.  \\r\\n**Questions this data set may help answer:**\\r\\n- What vulnerable infrastructure are you using?\\r\\n- What unique web components is the threat actor using that can track them to other domains?\\r\\n- Are any components marked as malicious?\\r\\n- What is the number of web components identified?\\r\\n- Are there any unique or strange technologies not often seen?\\r\\n- Are there any fake versions of specific technologies?\\r\\n- What is the frequency of changes in web components–often or rarely done?\\r\\n- Are there any suspicious libraries known to be abused?\\r\\n- Are there any technologies with vulnerabilities associated with them?\\r\\n\\r\\n\",\"style\":\"info\"},\"customWidth\":\"50\",\"name\":\"text - 0\"},{\"type\":1,\"content\":{\"json\":\"\\r\\n\\r\\n\\r\\nTrackers are unique codes or values found within web pages and often used to track user interaction. These codes can be used to correlate a disparate group of websites to a central entity. Often, actors will copy the source code of a victim’s website they are looking to impersonate for a phishing campaign. Seldomly will actors take the time to remove these IDs that allow users to identify these fraudulent sites using Microsoft’s Trackers data set. Actors may also deploy tracker IDs to see how successful their cyber-attack campaigns are. This is similar to marketers when they leverage SEO IDs, such as a Google Analytics Tracker ID, to track the success of their marketing campaign.\\r\\n\\r\\n**Questions this data set may help answer:**\\r\\n- Are there other resources using the same analytics IDs?\\r\\n- Are these resources associated with the organization, or are they attempting to conduct an infringement attack?\\r\\n- Is there any overlap between trackers–are they shared with other websites?\\r\\n- What are the types of trackers found within the web page?\\r\\n- What is the length of time for trackers?\\r\\n- What is the frequency of change for tracker values– do they come, go, or remain?\\r\\n- Are there any trackers linking to website cloning software (MarkOfTheWeb or HTTrack)?\\r\\n- Are there any trackers linking to malicious C2 server malware (JARM)?\\r\\n\\r\\n\",\"style\":\"info\"},\"customWidth\":\"50\",\"name\":\"text - 1\"},{\"type\":1,\"content\":{\"json\":\"Cookies are small pieces of data sent from a server to a client as the user browses the internet. These values sometimes contain a state for the application or little bits of tracking data. Defender TI highlights and indexes cookie names observed when crawling a website and allows users to dig into everywhere we have observed specific cookie names across its crawling and data collection. Cookies are also used by malicious actors to keep track of infected victims or store data to be used later.\\r\\n\\r\\n**Our cookie data includes the following:**\\r\\n- What other websites are issuing the same cookies?\\r\\n- What other websites are tracking the same cookies? \\r\\n- Does the cookie domain match your query?\\r\\n- What is the number of cookies associated with the artifact?\\r\\n- Are there unique cookie names or domains?\\r\\n- What are the time periods associated with cookies?\\r\\n- What is the frequency of newly observed cookies or changes associated with cookies?\",\"style\":\"info\"},\"customWidth\":\"50\",\"name\":\"text - 2\"},{\"type\":1,\"content\":{\"json\":\"Section containing list of approved Threat Actors and Tools identified and tracked by Microsoft. Sophisticated security professionals can use Microsoft’s Intel Profiles, along with indicators and other associated markers to automate defense of their organizations and track potentially malicious activity targeting their organization or industry. \\r\\n\\r\\n**Hierarchy**\\r\\nIntel Profiles\\r\\nThreat Profiles (including tracked dev-groups)\\r\\nTool Profiles\\r\\n\",\"style\":\"info\"},\"customWidth\":\"50\",\"name\":\"text - 2 - Copy\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"guide\"},\"name\":\"group - 22\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"loadType\":\"always\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"29e3c12d-0bcb-4c29-a392-bf965921fa95\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Vulnerability\",\"label\":\"Search Vulnerability via ID\",\"type\":1,\"timeContext\":{\"durationMs\":86400000},\"value\":\"CVE-2022-47966\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":1,\"content\":{\"json\":\"**CVEs (Common Vulnerabilities and Exposures)** can be used for threat hunting by identifying vulnerabilities in the system or network, evaluating them using the CVSS framework to determine their severity, prioritizing them based on their risk level, and mitigating them to reduce the risk of exploitation.\",\"style\":\"info\"},\"name\":\"text - 5\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"0c0a89c1-da06-47e6-b336-0a3379a766d2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"CVEHid\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetSingleVulnerability?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"x\"},\"name\":\"parameters - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print vuln=dynamic({CVEHid})\\r\\n| evaluate bag_unpack(vuln)\\r\\n\\r\\n\",\"size\":3,\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5},{\"columnMatch\":\"activeExploitsObserved\",\"formatter\":5},{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"description\",\"formatter\":5},{\"columnMatch\":\"exploitsAvailable\",\"formatter\":5},{\"columnMatch\":\"hasChatter\",\"formatter\":5},{\"columnMatch\":\"remediation\",\"formatter\":5}]},\"sortBy\":[],\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"@odata.context\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"priorityScore\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"name\":\"query - 9\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetComponentsFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Components of vulnerability \",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true}},\"customWidth\":\"50\",\"name\":\"query - 2\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetArticlesFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":0,\"title\":\"Vulnerability Tags\",\"queryType\":10,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"tags\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Tags\",\"text\":\"{0}{1}\"}]}},\"showBorder\":true,\"sortCriteriaField\":\"tags\"}},\"customWidth\":\"50\",\"name\":\"query - 4\",\"styleSettings\":{\"showBorder\":true}},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"3e6fdb53-b8b8-42f9-9483-b54d24f547d9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"articlehid\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetArticlesFromVulnerabilities?Vulnerability={Vulnerability}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print vuln=dynamic({articlehid})\\r\\n| evaluate bag_unpack(vuln)\\r\\n| mvexpand value\\r\\n| evaluate bag_unpack(value)\\r\\n|  extend Icon = strcat(\\\"🌐\\\")\\r\\n|  extend Url = strcat(\\\"https://ti.defender.microsoft.com/article/\\\", id)\\r\\n| sort by createdDateTime\\r\\n\",\"size\":0,\"title\":\"Relevant Articles From CVE\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5},{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"body\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"imageUrl\",\"formatter\":5},{\"columnMatch\":\"isFeatured\",\"formatter\":5},{\"columnMatch\":\"summary\",\"formatter\":5},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"labelSettings\":[{\"columnId\":\"title\",\"label\":\"Article Name\"},{\"columnId\":\"Icon\",\"label\":\" \"}]}},\"name\":\"query - 9\"}],\"exportParameters\":true},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Vulnerabilities\"},\"name\":\"Vulnerability \"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**Defender TI articles**\\r\\nArticles are narratives by Microsoft that provide insight into threat actors, tooling, attacks, and vulnerabilities. Defender TI featured and articles are not blog posts about threat intelligence; while they summarize different threats, they also link to actionable content and key indicators of compromise to help users take action. By including this technical information in the threat summaries, we enable users to continually track threat actors, tooling, attacks, and vulnerabilities as they change. With the Articles you are enabled to do the following \\r\\n- Stay informed about the latest cyber threats: MDTI articles provide up-to-date information on the latest cyber threats, including malware, phishing attacks, and other types of cybercrime. By regularly reading MDTI articles, you can stay informed about the latest tactics and techniques used by cybercriminals.\\r\\n- Understand the nature and scope of cyber threats: MDTI articles provide detailed analysis of the nature and scope of cyber threats, including the vulnerabilities that cybercriminals exploit and the impact that attacks can have on your organization. By understanding these threats, you can take proactive measures to prevent them from happening.\\r\\n- Learn how to respond to cyber threats: MDTI articles often provide actionable advice on how to respond to cyber threats, including steps you can take to mitigate the impact of an attack and prevent it from spreading. By following these best practices, you can minimize the damage caused by a cyber attack and recover more quickly.\\r\\n- Share information with your security team: MDTI articles can be a valuable resource for your organization's security team. By sharing these articles with your team, you can help them stay informed about the latest threats and take proactive measures to protect your organization's systems and data.\",\"style\":\"info\"},\"name\":\"text - 4\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"2d027e22-2c31-4f0a-9542-e584241b4253\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"articlehid2\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListArticles\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print article=dynamic({articlehid2})\\r\\n| mvexpand article\\r\\n| evaluate bag_unpack(article)\\r\\n| where todatetime(createdDateTime) > ago(60d)\\r\\n|  extend Icon = strcat(\\\"🌐\\\")\\r\\n|  extend Url = strcat(\\\"https://ti.defender.microsoft.com/article/\\\", id)\\r\\n| sort by createdDateTime\\r\\n\\r\\n\",\"size\":0,\"title\":\"New Articles in the last 60 Days\",\"timeContext\":{\"durationMs\":7772400000,\"endTime\":\"2023-05-01T22:06:00.000Z\"},\"exportFieldName\":\"id\",\"exportParameterName\":\"ArticleHid\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"body\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"imageUrl\",\"formatter\":5},{\"columnMatch\":\"isFeatured\",\"formatter\":5},{\"columnMatch\":\"summary\",\"formatter\":5},{\"columnMatch\":\"title\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"97.571ch\"}},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true}},\"name\":\"query - 9\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f14830cc-89ee-4974-9219-8a2341e321b9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"articleHid\",\"type\":1,\"isRequired\":true,\"isGlobal\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetSingleArticle?article={ArticleHid}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 5\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print article=dynamic({articleHid})\\r\\n| evaluate bag_unpack(article)\\r\\n|  extend Icon = strcat(\\\"🌐\\\")\\r\\n|  extend Url = strcat(\\\"https://ti.defender.microsoft.com/article/\\\", id)\\r\\n//| mvexpand(tags)\\r\\n\",\"size\":1,\"title\":\"Single Article (Select one of the articles on the full article list)\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"isFeatured\",\"formatter\":5},{\"columnMatch\":\"title\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"80.5699ch\"}},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"imageUrl\",\"formatter\":5}],\"filter\":true,\"sortBy\":[{\"itemKey\":\"title\",\"sortOrder\":1}],\"labelSettings\":[{\"columnId\":\"tags\",\"label\":\"Article_Tags\"},{\"columnId\":\"title\",\"label\":\"Article_Title\"},{\"columnId\":\"Icon\",\"label\":\" \"}]},\"sortBy\":[{\"itemKey\":\"title\",\"sortOrder\":1}],\"graphSettings\":{\"type\":0}},\"name\":\"query - 7\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"9d77e2d1-e32e-4b2f-9dec-3339a2282278\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"articleiocHid\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetIndictorFromArticle?article={ArticleHid}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"typeSettings\":{\"multiLineText\":true,\"editorLanguage\":\"text\"},\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 8\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print article=dynamic({articleiocHid})\\r\\n| evaluate bag_unpack(article)\\r\\n| mvexpand value\\r\\n|extend id = tostring(parse_json(value).id)\\r\\n|extend source = tostring(parse_json(value).source)\\r\\n|extend artifacttmp1 = tostring(parse_json(value).artifact)\\r\\n| extend artifacttmp2 = trim_start(\\\"@{@odata.type=#microsoft.graph.security.\\\", artifacttmp1)\\r\\n| extend artifacttmp3 = tostring(split(artifacttmp2,  \\\";\\\", 0))\\r\\n| extend artifacttmp4 = (split(artifacttmp2,  \\\"id=\\\", 1))\\r\\n| extend artifacttmp5 = (split(artifacttmp4,  \\\"; kind\\\", 0))\\r\\n| extend artifacttmp6 = (split(artifacttmp4,  \\\"; kind=\\\", 1))\\r\\n| extend artifacttmp7 = (split(artifacttmp6,  \\\"; value\\\", 0))\\r\\n\\r\\n//| extend artifacttmp5 = trim_end( '}\\\"]', artifacttmp4)\\r\\n//| evaluate bag_unpack(artifacttmp4)\\r\\n\\r\\n\",\"size\":0,\"title\":\"IOC's From Article  (Select one of the articles on the full article list)\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5},{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"value\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"source\",\"formatter\":5},{\"columnMatch\":\"artifacttmp1\",\"formatter\":5},{\"columnMatch\":\"artifacttmp2\",\"formatter\":5},{\"columnMatch\":\"artifacttmp4\",\"formatter\":5},{\"columnMatch\":\"artifacttmp6\",\"formatter\":5}],\"labelSettings\":[{\"columnId\":\"artifacttmp3\",\"label\":\"IoC_Type\"},{\"columnId\":\"artifacttmp5\",\"label\":\"IoC_Value\"},{\"columnId\":\"artifacttmp7\",\"label\":\"IoC_Type_Meta\"}]}},\"name\":\"query - 9\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ArticlesList\"},\"name\":\"Articles\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"185.82.217.3\",\"label\":\"Search IP address\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.resourcegraph/resources\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"parameters - 1\"},{\"type\":1,\"content\":{\"json\":\"The IP address information tab in the **MDTI workbook** facilitates the following functions:\\r\\n\\r\\n- It allows the user to ascertain the threat intelligence details, location, and reputation of an IP address in relation to intelligence profiles and underlying information.(Part of a blocklist , infrastucture exhibiting suspicious behaviour)\\r\\n- It displays tracker information.\\r\\n- It displays cookie information.\\r\\n- It displays component inforamtion\\r\\n\",\"style\":\"info\"},\"name\":\"text - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress\\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforIPAddress?Ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\",\\\"columnType\\\":\\\"long\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"visualization\":\"tiles\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Classification\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"Score\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"15\",\"name\":\"query - 3 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPAddressInformation?ipadress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":0,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"visualization\":\"map\",\"sortBy\":[],\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"countryOrRegion\",\"sizeSettings\":\"ASN_number\",\"sizeAggregation\":\"Count\",\"legendMetric\":\"ASN_number\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ASN_number\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"},\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}}},\"customWidth\":\"30\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ComponentsForIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Components\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Crypto\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"category\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Command and Control Server\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"TiLink\",\"formatter\":1,\"formatOptions\":{\"linkColumn\":\"name\",\"linkTarget\":\"Url\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"https://prod.ti.trafficmanager.net/search/components/ips?category=JavaScript%20Library&query=CryptoJS&version=\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"55\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/IPAddressInformation?ipadress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":1,\"title\":\"IP Address Information\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"filter\":true},\"sortBy\":[]},\"customWidth\":\"45\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforIPAddress?Ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"MDTI Threat Intelligence Details\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"low\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"high\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"relatedDetailsUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"link\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"55\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/CookiesIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"IP Address Cookies infromation\",\"queryType\":10},\"customWidth\":\"45\",\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/TrackersforIPAddress?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"IP Address Trackers information\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"kind\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Jarm\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Markoftheweb\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"55\",\"name\":\"query - 9\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://mdti-api.azurewebsites.net/api/HostnameComponents?hostname='{hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"Hostcomponents - Copy\"}]},\"customWidth\":\"100\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"IpAddress\"},\"name\":\"IpAddresses-5\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"iplis.ru\",\"label\":\"Search Hostname\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":1,\"content\":{\"json\":\"The Hostname information tab in the MDTI workbook facilitates the following functions:\\r\\n\\r\\n- It allows the user to ascertain the threat intelligence details , location, and reputation of an Hostname in relation to intelligence profiles and underlying information.(Part of a blocklist , infrastucture exhibiting suspicious behaviour)\\r\\n- It displays tracker information.\\r\\n- It displays cookie information.\\r\\n- it displays component information.\\r\\n\",\"style\":\"info\"},\"name\":\"text - 10\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress\\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.classification\\\",\\\"columnid\\\":\\\"Classification\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.score\\\",\\\"columnid\\\":\\\"Score\\\",\\\"columnType\\\":\\\"long\\\"}]}}]}\",\"size\":4,\"queryType\":10,\"visualization\":\"tiles\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Score\",\"formatter\":8,\"formatOptions\":{\"min\":0,\"max\":100,\"palette\":\"greenRed\"}}]},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Classification\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Score\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\">\",\"thresholdValue\":\"70\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\">\",\"thresholdValue\":\"50\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"Score\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"15\",\"name\":\"query - 3 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostInformation?hostname={Hostname}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":0,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"visualization\":\"map\",\"sortBy\":[],\"mapSettings\":{\"locInfo\":\"CountryRegion\",\"locInfoColumn\":\"countryOrRegion\",\"sizeSettings\":\"ASN_number\",\"sizeAggregation\":\"Count\",\"legendMetric\":\"ASN_number\",\"legendAggregation\":\"Count\",\"itemColorSettings\":{\"nodeColorField\":\"ASN_number\",\"colorAggregation\":\"Sum\",\"type\":\"heatmap\",\"heatmapPalette\":\"greenRed\"},\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}}},\"customWidth\":\"30\",\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ComponentsforHostname?clientId=hostkey1&hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Components\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"name\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Crypto\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Mark\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"category\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Command and Control Server\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"TiLink\",\"formatter\":1,\"formatOptions\":{\"linkColumn\":\"name\",\"linkTarget\":\"Url\"},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"https://prod.ti.trafficmanager.net/search/components/ips?category=JavaScript%20Library&query=CryptoJS&version=\"}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"firstSeenDateTime\",\"label\":\"First Seen\"},{\"columnId\":\"lastSeenDateTime\",\"label\":\"Last Seen\"},{\"columnId\":\"name\",\"label\":\"Name\"},{\"columnId\":\"version\",\"label\":\"Version\"},{\"columnId\":\"category\",\"label\":\"Category\"},{\"columnId\":\"host\",\"label\":\"Host\"}]},\"sortBy\":[]},\"customWidth\":\"55\",\"name\":\"query - 1 - Copy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/HostInformation?hostname={Hostname}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.id\\\",\\\"columnid\\\":\\\"name\\\"},{\\\"path\\\":\\\"$.firstSeenDateTime\\\",\\\"columnid\\\":\\\"firstSeenDateTime\\\"},{\\\"path\\\":\\\"$.lastSeenDateTime\\\",\\\"columnid\\\":\\\"lastSeenDateTime\\\"},{\\\"path\\\":\\\"$.countryOrRegion\\\",\\\"columnid\\\":\\\"countryOrRegion\\\"},{\\\"path\\\":\\\"$.netblock\\\",\\\"columnid\\\":\\\"netblock\\\"},{\\\"path\\\":\\\"$.hostingProvider\\\",\\\"columnid\\\":\\\"hostingProvider\\\"},{\\\"path\\\":\\\"$.autonomousSystem.name\\\",\\\"columnid\\\":\\\"ASN_name\\\"},{\\\"path\\\":\\\"$.autonomousSystem.number\\\",\\\"columnid\\\":\\\"ASN_number\\\"},{\\\"path\\\":\\\"$.autonomousSystem.organization\\\",\\\"columnid\\\":\\\"ASN_organization\\\"},{\\\"path\\\":\\\"$.autonomousSystem.value\\\",\\\"columnid\\\":\\\"ASN_value\\\"}]}}]}\",\"size\":1,\"title\":\"Hostname Information\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"filter\":true},\"sortBy\":[]},\"customWidth\":\"45\",\"name\":\"query - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ReputationforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.rules\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Threat intelligence Details\",\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"medium\",\"representation\":\"orange\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"high\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"low\",\"representation\":\"blue\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"relatedDetailsUrl\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"link\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}}],\"filter\":true,\"sortBy\":[{\"itemKey\":\"$gen_thresholds_severity_2\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"$gen_thresholds_severity_2\",\"sortOrder\":1}]},\"customWidth\":\"55\",\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/CookiesforHostname?hostname='{Hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Hostname Cookies infromation\",\"queryType\":10},\"customWidth\":\"45\",\"name\":\"query - 8\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/TrackersforHostname?hostname={Hostname}\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"title\":\"Hostname Trackers\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"kind\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"colors\",\"thresholdsGrid\":[{\"operator\":\"contains\",\"thresholdValue\":\"Jarm\",\"representation\":\"redBright\",\"text\":\"{0}{1}\"},{\"operator\":\"contains\",\"thresholdValue\":\"Mark\",\"representation\":\"red\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"text\":\"{0}{1}\"}]}}]}},\"customWidth\":\"55\",\"name\":\"query - 9\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hostname\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"dancevida.com\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"hostname\\\\\\\":\\\\\\\"{hostname}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"hostname\",\"exportParameterName\":\"hostname\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://mdti-api.azurewebsites.net/api/HostnameComponents?hostname='{hostname}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":1,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Hostcomponents\"},\"name\":\"Hostcomponents - Copy\"}]},\"customWidth\":\"100\",\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"HostName\"},\"name\":\"IpAddresses-5 - Copy\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f04ba5f4-a808-4ce1-b90f-bf09a9b95f09\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ipaddress\",\"type\":1,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"1.1.1.1\",\"label\":\"IP Address\"}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"1.0.0\\\",\\\"content\\\":\\\"{\\\\r\\\\n\\\\\\\"ipaddress \\\\\\\":\\\\\\\"{ipaddress}\\\\\\\"\\\\r\\\\n}\\\",\\\"transformers\\\":null}\",\"size\":0,\"exportFieldName\":\"ipaddress\",\"exportParameterName\":\"ipaddress\",\"exportToExcelOptions\":\"all\",\"queryType\":8},\"conditionalVisibility\":{\"parameterName\":\"y\",\"comparison\":\"isEqualTo\",\"value\":\"n\"},\"name\":\"query - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://mdti-api.azurewebsites.net/api/ipaddresstrackers?ipaddress='{ipaddress}'\\\",\\\"contentType\\\":\\\"application/json\\\",\\\"urlParams\\\":[],\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":2,\"exportToExcelOptions\":\"all\",\"queryType\":10,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"id\",\"formatter\":5}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"query - 1\"}]},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"ipaddresstrackers\"},\"name\":\"ipaddresstrackers\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"**Intel Profiles**, a single, reliable source of information in Microsoft Defender Threat Intelligence (Defender TI) security operations teams can use to have instant insight into the threat ecosystem, including pertinent details about vulnerabilities, threat actors, and infrastructure used in attacks. Intel profiles combine 65 trillion threat signals with the expertise of over 8,500 dedicated security professionals to translate that global threat landscape into immediately actionable insights. By comprehending their tactics, infrastructure, and methods of operation, security teams can take proactive steps to prevent threat actors from breaching their organization's defenses\",\"style\":\"info\"},\"name\":\"text - 5\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"e934d7fc-9429-44cf-b6d1-1d4ca3894c63\",\"cellValue\":\"Nav1\",\"linkTarget\":\"parameter\",\"linkLabel\":\"👺 Profiles\",\"subTarget\":\"ProfilesSubTab\",\"preText\":\"Profiles\",\"style\":\"link\"},{\"id\":\"38e6b677-8d88-4ce2-95e6-9215ebee48e2\",\"cellValue\":\"Nav1\",\"linkTarget\":\"parameter\",\"linkLabel\":\"🛠️ Tools\",\"subTarget\":\"ToolsSubTab\",\"preText\":\"Tools\",\"style\":\"link\"}]},\"name\":\"links - 8\"},{\"type\":1,\"content\":{\"json\":\"**Intel Profile List **\\r\\nThis shows all the published intel profiles , giving you visibility of the profiles of Threat actors and tooling you can use. You can search via Country , Sponsor States , Targets , Title and even industry\"},\"name\":\"text - 5\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"6d4c65e0-372e-4610-8f88-a9314a9763f5\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"hiddenprofile\",\"type\":1,\"isRequired\":true,\"isGlobal\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetSingleIntelProfile?profileId={ProfileID}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"above\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"7\"},\"name\":\"parameters - 5\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"1f1ef30a-9d27-4977-b1e0-f4bf20e9eb7d\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"profilelisthid\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/ListIntelProfile?\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 18\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print profile=dynamic({profilelisthid})\\r\\n| evaluate bag_unpack(profile)\\r\\n| mvexpand value\\r\\n| evaluate bag_unpack(value)\\r\\n| where kind != \\\"tool\\\"\\r\\n| extend sponsorStatesnew=todynamic(iff(array_length(sponsorStates)==0, '[{\\\"label\\\": \\\"None\\\"}]', sponsorStates))\\r\\n| mvexpand sponsorStatesnew\\r\\n| extend sponsorStates1 = tostring(split(sponsorStatesnew,  \\\":\\\", 1))\\r\\n| extend sponsorStates2 = tostring(split(sponsorStates1,  \\\",\\\", 0))\\r\\n| extend flag = case(sponsorStates2 contains \\\"Vietnam\\\",\\\"Vietnam 🇻🇳\\\",\\r\\n                         sponsorStates2 contains \\\"Iran\\\",\\\"Iran 🇮🇷\\\",\\r\\n                         sponsorStates2 contains \\\"China\\\",\\\"China 🇨🇳\\\",\\r\\n                         sponsorStates2 contains \\\"Israel\\\",\\\"Israel 🇮🇱\\\",\\r\\n                         sponsorStates2 contains \\\"North Korea\\\",\\\"North Korea 🇰🇵\\\",\\r\\n                         sponsorStates2 contains \\\"Russia\\\",\\\"Russia 🇷🇺\\\",\\r\\n                         \\\"Unknown\\\")\\r\\n|  extend icon = strcat(\\\"🌐\\\")\\r\\n|  extend Url = strcat(\\\"https://ti.defender.microsoft.com/intel-profiles/\\\", id)\\r\\n| sort by firstActiveDateTime\\r\\n                         \\r\\n\\r\\n\",\"size\":3,\"title\":\"Profile List\",\"timeContext\":{\"durationMs\":2592000000},\"exportFieldName\":\"id\",\"exportParameterName\":\"profilelistexp\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5},{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"kind\",\"formatter\":5},{\"columnMatch\":\"sponsorStates\",\"formatter\":5},{\"columnMatch\":\"targets\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"142.5706ch\"}},{\"columnMatch\":\"sponsorStates1\",\"formatter\":5},{\"columnMatch\":\"sponsorStates2\",\"formatter\":5},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"description\",\"formatter\":5},{\"columnMatch\":\"summary\",\"formatter\":5},{\"columnMatch\":\"tradecraft\",\"formatter\":5}],\"rowLimit\":500,\"filter\":true,\"labelSettings\":[{\"columnId\":\"title\",\"label\":\"Actor Name\"},{\"columnId\":\"flag\",\"label\":\"Sponsor Country\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"Nav1\",\"comparison\":\"isEqualTo\",\"value\":\"ProfilesSubTab\"},\"name\":\"query - 20\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"77ce7fed-ca2a-408e-a459-7e4886e3e410\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"profileid1\",\"type\":1,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"CustomEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"POST\\\",\\\"url\\\":\\\"https://{AzureFunction}.azurewebsites.net/api/GetIndictorFromIntelProfile?profileId={profilelistexp}\\\",\\\"contentType\\\":\\\"text/plain\\\",\\\"urlParams\\\":[],\\\"transformers\\\":null}\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":10}],\"style\":\"pills\",\"queryType\":10},\"conditionalVisibility\":{\"parameterName\":\"x\",\"comparison\":\"isEqualTo\",\"value\":\"y\"},\"name\":\"parameters - 6\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print profile=dynamic({profilelisthid})\\r\\n| evaluate bag_unpack(profile)\\r\\n| mvexpand value\\r\\n| evaluate bag_unpack(value)\\r\\n| where kind == \\\"tool\\\"\\r\\n|  extend Icon = strcat(\\\"🛠️\\\")\\r\\n|  extend Url = strcat(\\\"https://ti.defender.microsoft.com/intel-profiles/\\\", id)\\r\\n| sort by firstActiveDateTime\",\"size\":3,\"title\":\"🛠️🛠️ Tools\",\"timeContext\":{\"durationMs\":86400000},\"exportFieldName\":\"id\",\"exportParameterName\":\"profilelistexp\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"@odata.context\",\"formatter\":5},{\"columnMatch\":\"defaultVisualization\",\"formatter\":5},{\"columnMatch\":\"aliases\",\"formatter\":5},{\"columnMatch\":\"id\",\"formatter\":5},{\"columnMatch\":\"kind\",\"formatter\":5},{\"columnMatch\":\"sponsorStates\",\"formatter\":5},{\"columnMatch\":\"targets\",\"formatter\":5},{\"columnMatch\":\"Url\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Url\"}},{\"columnMatch\":\"description\",\"formatter\":5},{\"columnMatch\":\"summary\",\"formatter\":5},{\"columnMatch\":\"tradecraft\",\"formatter\":5}]}},\"conditionalVisibilities\":[{\"parameterName\":\"Nav1\",\"comparison\":\"isEqualTo\",\"value\":\"ToolsSubTab\"},{\"parameterName\":\"profilelisthid\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"query - 19\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"print profile=dynamic({profileid1})\\r\\n| evaluate bag_unpack(profile)\\r\\n| mvexpand value\\r\\n| evaluate bag_unpack(value)\\r\\n| extend tostring(artifact)\\r\\n| parse-kv artifact as (id: string, value: string) with (pair_delimiter=';', kv_delimiter='=')\\r\\n| parse artifact with * \\\"kind=\\\" typenew \\r\\n| extend type2 = tostring(split(typenew,  \\\";\\\", 0))\\r\\n| project firstSeenDateTime, lastSeenDateTime, IoC_Type = type2, IoC_Value = trim( \\\"}\\\", value)\\r\\n\\r\\n\",\"size\":0,\"title\":\"IoC from Profile\",\"timeContext\":{\"durationMs\":86400000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"IoC_Value\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"79.2849ch\"}}],\"sortBy\":[{\"itemKey\":\"firstSeenDateTime\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"firstSeenDateTime\",\"sortOrder\":1}]},\"conditionalVisibilities\":[{\"parameterName\":\"Nav1\",\"comparison\":\"isEqualTo\",\"value\":\"ProfilesSubTab\"},{\"parameterName\":\"profileid1\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"query - 7\"}],\"exportParameters\":true},\"conditionalVisibility\":{\"parameterName\":\"Nav\",\"comparison\":\"isEqualTo\",\"value\":\"Intels\"},\"name\":\"intel-profile\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"azure monitor\"]}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}